box: golang
build:
  steps:
    # Sets the go workspace and places you package
    # at the right place in the workspace tree
    - setup-go-workspace
    # Gets the dependencies
    - script:
        name: go get
        code: |
          go get

    # Build the project
    - script:
        name: go build
        code: |          
          go build -o $WERCKER_OUTPUT_DIR/imclient ./...
          cp -r "$WERCKER_OUTPUT_DIR/imclient" "$WERCKER_REPORT_ARTIFACTS_DIR"

    # Test the project
    - script:
        name: go test
        code: |
          go test ./...

push-test:
    box:
        id: ubuntu
        tag: latest

    steps:
    - script:
        name: install dependencies
        code: |
            yum -y install git && yum clean all

    - script:
        name: SayHello
        code: echo "Hello world"
